{"version":3,"file":"collection-types.mjs","sources":["../../../server/src/controllers/collection-types.ts"],"sourcesContent":["import { isNil } from 'lodash/fp';\n\nimport { setCreatorFields, async, errors } from '@strapi/utils';\nimport type { Modules, UID } from '@strapi/types';\n\nimport { getService } from '../utils';\nimport { validateBulkActionInput } from './validation';\nimport { getProhibitedCloningFields, excludeNotCreatableFields } from './utils/clone';\nimport { getDocumentLocaleAndStatus } from './validation/dimensions';\nimport { formatDocumentWithMetadata } from './utils/metadata';\nimport { indexByDocumentId } from './utils/document-status';\n\ntype Options = Modules.Documents.Params.Pick<UID.ContentType, 'populate:object'>;\n\n/**\n * Create a new document.\n *\n * @param ctx - Koa context\n * @param opts - Options\n * @param opts.populate - Populate options of the returned document.\n *                        By default documentManager will populate all relations.\n */\nconst createDocument = async (ctx: any, opts?: Options) => {\n  const { userAbility, user } = ctx.state;\n  const { model } = ctx.params;\n  const { body } = ctx.request;\n\n  const documentManager = getService('document-manager');\n  const permissionChecker = getService('permission-checker').create({ userAbility, model });\n\n  if (permissionChecker.cannot.create()) {\n    throw new errors.ForbiddenError();\n  }\n\n  const pickPermittedFields = permissionChecker.sanitizeCreateInput;\n  const setCreator = setCreatorFields({ user });\n  const sanitizeFn = async.pipe(pickPermittedFields, setCreator as any);\n  const sanitizedBody = await sanitizeFn(body);\n\n  const { locale, status } = await getDocumentLocaleAndStatus(body, model);\n\n  return documentManager.create(model, {\n    data: sanitizedBody as any,\n    locale,\n    status,\n    populate: opts?.populate,\n  });\n\n  // TODO: Revert the creation if create permission conditions are not met\n  // if (permissionChecker.cannot.create(document)) {\n  //   throw new errors.ForbiddenError();\n  // }\n};\n\n/**\n * Update a document version.\n * - If the document version exists, it will be updated.\n * - If the document version does not exist, a new document locale will be created.\n *   By default documentManager will populate all relations.\n *\n * @param ctx - Koa context\n * @param opts - Options\n * @param opts.populate - Populate options of the returned document\n */\nconst updateDocument = async (ctx: any, opts?: Options) => {\n  const { userAbility, user } = ctx.state;\n  const { id, model } = ctx.params;\n  const { body } = ctx.request;\n\n  const documentManager = getService('document-manager');\n  const permissionChecker = getService('permission-checker').create({ userAbility, model });\n\n  if (permissionChecker.cannot.update()) {\n    throw new errors.ForbiddenError();\n  }\n\n  // Populate necessary fields to check permissions\n  const permissionQuery = await permissionChecker.sanitizedQuery.update(ctx.query);\n  const populate = await getService('populate-builder')(model)\n    .populateFromQuery(permissionQuery)\n    .build();\n\n  const { locale } = await getDocumentLocaleAndStatus(body, model);\n\n  // Load document version to update\n  const [documentVersion, documentExists] = await Promise.all([\n    documentManager.findOne(id, model, { populate, locale, status: 'draft' }),\n    documentManager.exists(model, id),\n  ]);\n\n  if (!documentExists) {\n    throw new errors.NotFoundError();\n  }\n\n  // If version is not found, but document exists,\n  // the intent is to create a new document locale\n  if (documentVersion) {\n    if (permissionChecker.cannot.update(documentVersion)) {\n      throw new errors.ForbiddenError();\n    }\n  } else if (permissionChecker.cannot.create()) {\n    throw new errors.ForbiddenError();\n  }\n\n  const pickPermittedFields = documentVersion\n    ? permissionChecker.sanitizeUpdateInput(documentVersion)\n    : permissionChecker.sanitizeCreateInput;\n  const setCreator = documentVersion\n    ? setCreatorFields({ user, isEdition: true })\n    : setCreatorFields({ user });\n  const sanitizeFn = async.pipe(pickPermittedFields, setCreator as any);\n  const sanitizedBody = await sanitizeFn(body);\n\n  const updatedDocument = await documentManager.update(documentVersion?.documentId || id, model, {\n    data: sanitizedBody as any,\n    populate: opts?.populate,\n    locale,\n  });\n\n  return updatedDocument;\n};\n\nexport default {\n  async find(ctx: any) {\n    const { userAbility } = ctx.state;\n    const { model } = ctx.params;\n    const { query } = ctx.request;\n\n    const documentMetadata = getService('document-metadata');\n    const documentManager = getService('document-manager');\n    const permissionChecker = getService('permission-checker').create({ userAbility, model });\n\n    if (permissionChecker.cannot.read()) {\n      return ctx.forbidden();\n    }\n\n    const permissionQuery = await permissionChecker.sanitizedQuery.read(query);\n\n    const populate = await getService('populate-builder')(model)\n      .populateFromQuery(permissionQuery)\n      .populateDeep(1)\n      .countRelations({ toOne: false, toMany: true })\n      .build();\n\n    const { locale, status } = await getDocumentLocaleAndStatus(query, model);\n\n    const { results: documents, pagination } = await documentManager.findPage(\n      { ...permissionQuery, populate, locale, status },\n      model\n    );\n\n    // TODO: Skip this part if not necessary (if D&P disabled or columns not displayed in the view)\n    const documentsAvailableStatus = await documentMetadata.getManyAvailableStatus(\n      model,\n      documents\n    );\n\n    const statusByDocumentId = indexByDocumentId(documentsAvailableStatus);\n\n    const setStatus = (document: any) => {\n      // Available status of document\n      const availableStatuses = statusByDocumentId.get(document.documentId) || [];\n      // Compute document version status\n      document.status = documentMetadata.getStatus(document, availableStatuses);\n      return document;\n    };\n\n    const results = await async.map(\n      documents,\n      async.pipe(permissionChecker.sanitizeOutput, setStatus)\n    );\n\n    ctx.body = {\n      results,\n      pagination,\n    };\n  },\n\n  async findOne(ctx: any) {\n    const { userAbility } = ctx.state;\n    const { model, id } = ctx.params;\n\n    const documentManager = getService('document-manager');\n    const permissionChecker = getService('permission-checker').create({ userAbility, model });\n\n    if (permissionChecker.cannot.read()) {\n      return ctx.forbidden();\n    }\n\n    const permissionQuery = await permissionChecker.sanitizedQuery.read(ctx.query);\n    const populate = await getService('populate-builder')(model)\n      .populateFromQuery(permissionQuery)\n      .populateDeep(Infinity)\n      .countRelations()\n      .build();\n\n    const { locale, status } = await getDocumentLocaleAndStatus(ctx.query, model);\n\n    const version = await documentManager.findOne(id, model, {\n      populate,\n      locale,\n      status,\n    });\n\n    if (!version) {\n      // Check if document exists\n      const exists = await documentManager.exists(model, id);\n      if (!exists) {\n        return ctx.notFound();\n      }\n\n      // If the requested locale doesn't exist, return an empty response\n      const { meta } = await formatDocumentWithMetadata(\n        permissionChecker,\n        model,\n        // @ts-expect-error TODO: fix\n        { documentId: id, locale, publishedAt: null },\n        { availableLocales: true, availableStatus: false }\n      );\n\n      ctx.body = { data: {}, meta };\n\n      return;\n    }\n\n    // if the user has condition that needs populated content, it's not applied because entity don't have relations populated\n    if (permissionChecker.cannot.read(version)) {\n      return ctx.forbidden();\n    }\n\n    // TODO: Count populated relations by permissions\n    const sanitizedDocument = await permissionChecker.sanitizeOutput(version);\n    ctx.body = await formatDocumentWithMetadata(permissionChecker, model, sanitizedDocument);\n  },\n\n  async create(ctx: any) {\n    const { userAbility } = ctx.state;\n    const { model } = ctx.params;\n\n    const permissionChecker = getService('permission-checker').create({ userAbility, model });\n\n    const [totalEntries, document] = await Promise.all([\n      strapi.db.query(model).count(),\n      createDocument(ctx),\n    ]);\n\n    const sanitizedDocument = await permissionChecker.sanitizeOutput(document);\n    ctx.status = 201;\n    ctx.body = await formatDocumentWithMetadata(permissionChecker, model, sanitizedDocument, {\n      // Empty metadata as it's not relevant for a new document\n      availableLocales: false,\n      availableStatus: false,\n    });\n\n    if (totalEntries === 0) {\n      strapi.telemetry.send('didCreateFirstContentTypeEntry', {\n        eventProperties: { model },\n      });\n    }\n  },\n\n  async update(ctx: any) {\n    const { userAbility } = ctx.state;\n    const { model } = ctx.params;\n\n    const permissionChecker = getService('permission-checker').create({ userAbility, model });\n\n    const updatedVersion = await updateDocument(ctx);\n\n    const sanitizedVersion = await permissionChecker.sanitizeOutput(updatedVersion);\n    ctx.body = await formatDocumentWithMetadata(permissionChecker, model, sanitizedVersion);\n  },\n\n  async clone(ctx: any) {\n    const { userAbility, user } = ctx.state;\n    const { model, sourceId: id } = ctx.params;\n    const { body } = ctx.request;\n\n    const documentManager = getService('document-manager');\n    const permissionChecker = getService('permission-checker').create({ userAbility, model });\n\n    if (permissionChecker.cannot.create()) {\n      return ctx.forbidden();\n    }\n\n    const permissionQuery = await permissionChecker.sanitizedQuery.create(ctx.query);\n    const populate = await getService('populate-builder')(model)\n      .populateFromQuery(permissionQuery)\n      .build();\n\n    const { locale } = await getDocumentLocaleAndStatus(body, model);\n    const document = await documentManager.findOne(id, model, {\n      populate,\n      locale,\n      status: 'draft',\n    });\n\n    if (!document) {\n      return ctx.notFound();\n    }\n\n    const pickPermittedFields = permissionChecker.sanitizeCreateInput;\n    const setCreator = setCreatorFields({ user });\n    const excludeNotCreatable = excludeNotCreatableFields(model, permissionChecker);\n    const sanitizeFn = async.pipe(pickPermittedFields, setCreator as any, excludeNotCreatable);\n    const sanitizedBody = await sanitizeFn(body);\n\n    const clonedDocument = await documentManager.clone(document.documentId, sanitizedBody, model);\n\n    const sanitizedDocument = await permissionChecker.sanitizeOutput(clonedDocument);\n    ctx.body = await formatDocumentWithMetadata(permissionChecker, model, sanitizedDocument, {\n      // Empty metadata as it's not relevant for a new document\n      availableLocales: false,\n      availableStatus: false,\n    });\n  },\n\n  async autoClone(ctx: any) {\n    const { model } = ctx.params;\n\n    // Check if the model has fields that prevent auto cloning\n    const prohibitedFields = getProhibitedCloningFields(model);\n\n    if (prohibitedFields.length > 0) {\n      return ctx.badRequest(\n        'Entity could not be cloned as it has unique and/or relational fields. ' +\n          'Please edit those fields manually and save to complete the cloning.',\n        {\n          prohibitedFields,\n        }\n      );\n    }\n\n    await this.clone(ctx);\n  },\n\n  async delete(ctx: any) {\n    const { userAbility } = ctx.state;\n    const { id, model } = ctx.params;\n\n    const documentManager = getService('document-manager');\n    const permissionChecker = getService('permission-checker').create({ userAbility, model });\n\n    if (permissionChecker.cannot.delete()) {\n      return ctx.forbidden();\n    }\n\n    const permissionQuery = await permissionChecker.sanitizedQuery.delete(ctx.query);\n    const populate = await getService('populate-builder')(model)\n      .populateFromQuery(permissionQuery)\n      .build();\n\n    const { locale } = await getDocumentLocaleAndStatus(ctx.query, model);\n\n    // Find locales to delete\n    const documentLocales = await documentManager.findLocales(id, model, { populate, locale });\n\n    if (documentLocales.length === 0) {\n      return ctx.notFound();\n    }\n\n    for (const document of documentLocales) {\n      if (permissionChecker.cannot.delete(document)) {\n        return ctx.forbidden();\n      }\n    }\n\n    const result = await documentManager.delete(id, model, { locale });\n\n    ctx.body = await permissionChecker.sanitizeOutput(result);\n  },\n\n  /**\n   * Publish a document version.\n   * Supports creating/saving a document and publishing it in one request.\n   */\n  async publish(ctx: any) {\n    const { userAbility } = ctx.state;\n    // If id does not exist, the document has to be created\n    const { id, model } = ctx.params;\n    const { body } = ctx.request;\n\n    const documentManager = getService('document-manager');\n    const permissionChecker = getService('permission-checker').create({ userAbility, model });\n\n    if (permissionChecker.cannot.publish()) {\n      return ctx.forbidden();\n    }\n\n    const publishedDocument = await strapi.db.transaction(async () => {\n      // Create or update document\n      const permissionQuery = await permissionChecker.sanitizedQuery.publish(ctx.query);\n      const populate = await getService('populate-builder')(model)\n        .populateFromQuery(permissionQuery)\n        .populateDeep(Infinity)\n        .countRelations()\n        .build();\n\n      let document: any;\n\n      const { locale } = await getDocumentLocaleAndStatus(body, model);\n\n      /**\n       * Publish can be called on two scenarios:\n       * 1. Create a new document and publish it in one request\n       * 2. Update an existing document and publish it in one request\n       *\n       * Based on user permissions:\n       * 1. User cannot create a document, but can publish\n       *    Action will be forbidden as user cannot create a document\n       * 2. User can update and publish a document\n       *    Action will be allowed, but document will not be updated, only published with the latest draft\n       */\n      const isCreate = isNil(id);\n      if (isCreate) {\n        if (permissionChecker.cannot.create()) {\n          throw new errors.ForbiddenError();\n        }\n\n        document = await createDocument(ctx, { populate });\n      }\n\n      const isUpdate = !isCreate;\n      if (isUpdate) {\n        // check if the document exists\n        const documentExists = await documentManager.exists(model, id);\n\n        if (!documentExists) {\n          throw new errors.NotFoundError('Document not found');\n        }\n\n        // check the document version\n        document = await documentManager.findOne(id!, model, { populate, locale });\n\n        if (!document) {\n          // update and publish the new version\n          if (\n            permissionChecker.cannot.create({ locale }) ||\n            permissionChecker.cannot.publish({ locale })\n          ) {\n            throw new errors.ForbiddenError();\n          }\n          document = await updateDocument(ctx);\n        } else if (permissionChecker.can.update(document)) {\n          await updateDocument(ctx);\n        }\n      }\n\n      if (permissionChecker.cannot.publish(document)) {\n        throw new errors.ForbiddenError();\n      }\n\n      const publishResult = await documentManager.publish(document.documentId, model, {\n        locale,\n        // TODO: Allow setting creator fields on publish\n        // data: setCreatorFields({ user, isEdition: true })({}),\n      });\n\n      if (!publishResult || publishResult.length === 0) {\n        throw new errors.NotFoundError('Document not found or already published.');\n      }\n\n      return publishResult[0];\n    });\n\n    const sanitizedDocument = await permissionChecker.sanitizeOutput(publishedDocument);\n    ctx.body = await formatDocumentWithMetadata(permissionChecker, model, sanitizedDocument);\n  },\n\n  async bulkPublish(ctx: any) {\n    const { userAbility } = ctx.state;\n    const { model } = ctx.params;\n    const { body } = ctx.request;\n    const { documentIds } = body;\n\n    await validateBulkActionInput(body);\n\n    const documentManager = getService('document-manager');\n    const permissionChecker = getService('permission-checker').create({ userAbility, model });\n\n    if (permissionChecker.cannot.publish()) {\n      return ctx.forbidden();\n    }\n\n    const permissionQuery = await permissionChecker.sanitizedQuery.publish(ctx.query);\n    const populate = await getService('populate-builder')(model)\n      .populateFromQuery(permissionQuery)\n      .populateDeep(Infinity)\n      .countRelations()\n      .build();\n\n    const { locale } = await getDocumentLocaleAndStatus(body, model, {\n      allowMultipleLocales: true,\n    });\n\n    const entityPromises = documentIds.map((documentId: any) =>\n      documentManager.findLocales(documentId, model, { populate, locale, isPublished: false })\n    );\n    const entities = (await Promise.all(entityPromises)).flat();\n\n    for (const entity of entities) {\n      if (!entity) {\n        return ctx.notFound();\n      }\n\n      if (permissionChecker.cannot.publish(entity)) {\n        return ctx.forbidden();\n      }\n    }\n\n    const count = await documentManager.publishMany(model, documentIds, locale);\n    ctx.body = { count };\n  },\n\n  async bulkUnpublish(ctx: any) {\n    const { userAbility } = ctx.state;\n    const { model } = ctx.params;\n    const { body } = ctx.request;\n    const { documentIds } = body;\n\n    await validateBulkActionInput(body);\n\n    const documentManager = getService('document-manager');\n    const permissionChecker = getService('permission-checker').create({ userAbility, model });\n\n    if (permissionChecker.cannot.unpublish()) {\n      return ctx.forbidden();\n    }\n\n    const { locale } = await getDocumentLocaleAndStatus(body, model, {\n      allowMultipleLocales: true,\n    });\n\n    const entityPromises = documentIds.map((documentId: any) =>\n      documentManager.findLocales(documentId, model, { locale, isPublished: true })\n    );\n    const entities = (await Promise.all(entityPromises)).flat();\n\n    for (const entity of entities) {\n      if (!entity) {\n        return ctx.notFound();\n      }\n\n      if (permissionChecker.cannot.publish(entity)) {\n        return ctx.forbidden();\n      }\n    }\n\n    const entitiesIds = entities.map((document) => document.documentId);\n\n    const { count } = await documentManager.unpublishMany(entitiesIds, model, { locale });\n\n    ctx.body = { count };\n  },\n\n  async unpublish(ctx: any) {\n    const { userAbility } = ctx.state;\n    const { id, model } = ctx.params;\n    const {\n      body: { discardDraft, ...body },\n    } = ctx.request;\n\n    const documentManager = getService('document-manager');\n    const permissionChecker = getService('permission-checker').create({ userAbility, model });\n\n    if (permissionChecker.cannot.unpublish()) {\n      return ctx.forbidden();\n    }\n\n    if (discardDraft && permissionChecker.cannot.discard()) {\n      return ctx.forbidden();\n    }\n\n    const permissionQuery = await permissionChecker.sanitizedQuery.unpublish(ctx.query);\n\n    const populate = await getService('populate-builder')(model)\n      .populateFromQuery(permissionQuery)\n      .build();\n\n    // TODO allow multiple locales for bulk locale unpublish\n    const { locale } = await getDocumentLocaleAndStatus(body, model);\n    const document = await documentManager.findOne(id, model, {\n      populate,\n      locale,\n      status: 'published',\n    });\n\n    if (!document) {\n      throw new errors.NotFoundError();\n    }\n\n    if (permissionChecker.cannot.unpublish(document)) {\n      throw new errors.ForbiddenError();\n    }\n\n    if (discardDraft && permissionChecker.cannot.discard(document)) {\n      throw new errors.ForbiddenError();\n    }\n\n    await strapi.db.transaction(async () => {\n      if (discardDraft) {\n        await documentManager.discardDraft(document.documentId, model, { locale });\n      }\n\n      ctx.body = await async.pipe(\n        (document) => documentManager.unpublish(document.documentId, model, { locale }),\n        permissionChecker.sanitizeOutput,\n        (document) => formatDocumentWithMetadata(permissionChecker, model, document)\n      )(document);\n    });\n  },\n\n  async discard(ctx: any) {\n    const { userAbility } = ctx.state;\n    const { id, model } = ctx.params;\n    const { body } = ctx.request;\n\n    const documentManager = getService('document-manager');\n    const permissionChecker = getService('permission-checker').create({ userAbility, model });\n\n    if (permissionChecker.cannot.discard()) {\n      return ctx.forbidden();\n    }\n\n    const permissionQuery = await permissionChecker.sanitizedQuery.discard(ctx.query);\n    const populate = await getService('populate-builder')(model)\n      .populateFromQuery(permissionQuery)\n      .build();\n\n    const { locale } = await getDocumentLocaleAndStatus(body, model);\n    const document = await documentManager.findOne(id, model, {\n      populate,\n      locale,\n      status: 'published',\n    });\n\n    // Can not discard a document that is not published\n    if (!document) {\n      return ctx.notFound();\n    }\n\n    if (permissionChecker.cannot.discard(document)) {\n      return ctx.forbidden();\n    }\n\n    ctx.body = await async.pipe(\n      (document) => documentManager.discardDraft(document.documentId, model, { locale }),\n      permissionChecker.sanitizeOutput,\n      (document) => formatDocumentWithMetadata(permissionChecker, model, document)\n    )(document);\n  },\n\n  async bulkDelete(ctx: any) {\n    const { userAbility } = ctx.state;\n    const { model } = ctx.params;\n    const { query, body } = ctx.request;\n    const { documentIds } = body;\n\n    await validateBulkActionInput(body);\n\n    const documentManager = getService('document-manager');\n    const permissionChecker = getService('permission-checker').create({ userAbility, model });\n\n    if (permissionChecker.cannot.delete()) {\n      return ctx.forbidden();\n    }\n\n    const permissionQuery = await permissionChecker.sanitizedQuery.delete(query);\n    const populate = await getService('populate-builder')(model)\n      .populateFromQuery(permissionQuery)\n      .build();\n\n    const { locale } = await getDocumentLocaleAndStatus(body, model);\n\n    const documentLocales = await documentManager.findLocales(documentIds, model, {\n      populate,\n      locale,\n    });\n\n    if (documentLocales.length === 0) {\n      return ctx.notFound();\n    }\n\n    for (const document of documentLocales) {\n      if (permissionChecker.cannot.delete(document)) {\n        return ctx.forbidden();\n      }\n    }\n\n    // We filter out documentsIds that maybe doesn't exist in a specific locale\n    const localeDocumentsIds = documentLocales.map((document) => document.documentId);\n\n    const { count } = await documentManager.deleteMany(localeDocumentsIds, model, { locale });\n\n    ctx.body = { count };\n  },\n\n  async countDraftRelations(ctx: any) {\n    const { userAbility } = ctx.state;\n    const { model, id } = ctx.params;\n\n    const documentManager = getService('document-manager');\n    const permissionChecker = getService('permission-checker').create({ userAbility, model });\n\n    if (permissionChecker.cannot.read()) {\n      return ctx.forbidden();\n    }\n\n    const { locale, status } = await getDocumentLocaleAndStatus(ctx.query, model);\n\n    if (permissionChecker.requiresEntity.read()) {\n      // Only load what we need for access checks\n      const entity = await documentManager.findOne(id, model, {\n        locale,\n        status,\n        populate: {},\n      });\n\n      if (!entity) {\n        return ctx.notFound();\n      }\n\n      if (permissionChecker.cannot.read(entity)) {\n        return ctx.forbidden();\n      }\n    }\n\n    const number = await documentManager.countDraftRelations(id, model, locale);\n\n    return {\n      data: number,\n    };\n  },\n\n  async countManyEntriesDraftRelations(ctx: any) {\n    const { userAbility } = ctx.state;\n    const ids = ctx.request.query.documentIds as string[];\n    const locale = ctx.request.query.locale as string[];\n    const { model } = ctx.params;\n\n    const documentManager = getService('document-manager');\n    const permissionChecker = getService('permission-checker').create({ userAbility, model });\n\n    if (permissionChecker.cannot.read()) {\n      return ctx.forbidden();\n    }\n\n    const documents = await documentManager.findMany(\n      {\n        filters: {\n          documentId: ids,\n        },\n        locale,\n      },\n      model\n    );\n\n    if (!documents) {\n      return ctx.notFound();\n    }\n\n    const number = await documentManager.countManyEntriesDraftRelations(ids, model, locale);\n\n    return {\n      data: number,\n    };\n  },\n};\n"],"names":["createDocument","ctx","opts","userAbility","user","state","model","params","body","request","documentManager","getService","permissionChecker","create","cannot","errors","ForbiddenError","pickPermittedFields","sanitizeCreateInput","setCreator","setCreatorFields","sanitizeFn","async","pipe","sanitizedBody","locale","status","getDocumentLocaleAndStatus","data","populate","updateDocument","id","update","permissionQuery","sanitizedQuery","query","populateFromQuery","build","documentVersion","documentExists","Promise","all","findOne","exists","NotFoundError","sanitizeUpdateInput","isEdition","updatedDocument","documentId","find","documentMetadata","read","forbidden","populateDeep","countRelations","toOne","toMany","results","documents","pagination","findPage","documentsAvailableStatus","getManyAvailableStatus","statusByDocumentId","indexByDocumentId","setStatus","document","availableStatuses","get","getStatus","map","sanitizeOutput","Infinity","version","notFound","meta","formatDocumentWithMetadata","publishedAt","availableLocales","availableStatus","sanitizedDocument","totalEntries","strapi","db","count","telemetry","send","eventProperties","updatedVersion","sanitizedVersion","clone","sourceId","excludeNotCreatable","excludeNotCreatableFields","clonedDocument","autoClone","prohibitedFields","getProhibitedCloningFields","length","badRequest","delete","documentLocales","findLocales","result","publish","publishedDocument","transaction","isCreate","isNil","isUpdate","can","publishResult","bulkPublish","documentIds","validateBulkActionInput","allowMultipleLocales","entityPromises","isPublished","entities","flat","entity","publishMany","bulkUnpublish","unpublish","entitiesIds","unpublishMany","discardDraft","discard","bulkDelete","localeDocumentsIds","deleteMany","countDraftRelations","requiresEntity","number","countManyEntriesDraftRelations","ids","findMany","filters"],"mappings":"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"}